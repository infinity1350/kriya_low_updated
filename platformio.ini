; PlatformIO Project Configuration File
;
; STM32 Battery Management System - Phase 2
; With TFT_eSPI, NeoPixel, and ROS integration
;
; Supported boards:
;   - genericSTM32F407VET6 (default)
;   - blackpill_f411ce

; ============================================================================
; Common settings for all environments
; ============================================================================
[common]
framework = arduino
monitor_speed = 115200

build_flags = 
	-D PIO_FRAMEWORK_ARDUINO_ENABLE_CDC
	-D USBCON
	-D USB_MANUFACTURER="STM32"
	-D USB_PRODUCT="\"STM32 BMS Controller\""
	-D HAL_PCD_MODULE_ENABLED
	-D USBD_USE_CDC
	

lib_deps = 
    bodmer/TFT_eSPI@^2.5.43
    adafruit/Adafruit NeoPixel@^1.12.0
    frankjoshua/Rosserial Arduino Library@^0.9.1

; ============================================================================
; STM32F407VET6 Environment (168MHz, 512KB Flash, 192KB RAM)
; ============================================================================
[env:genericSTM32F407VET6]
platform = ststm32
board = genericSTM32F407VET6
framework = ${common.framework}

; Upload configuration (USB DFU mode)
upload_protocol = stlink
; For ST-Link debugging, uncomment below:
; debug_tool = stlink

build_flags = ${common.build_flags}
monitor_speed = ${common.monitor_speed}
lib_deps = ${common.lib_deps}

; ============================================================================
; BlackPill F411CE Environment (100MHz, 512KB Flash, 128KB RAM)
; ============================================================================
[env:blackpill_f411ce]
platform = ststm32
board = blackpill_f411ce
framework = ${common.framework}

; Upload configuration (USB DFU mode - hold BOOT0, press NRST)
upload_protocol = dfu
; For ST-Link debugging, uncomment below:
; debug_tool = stlink

build_flags = ${common.build_flags}
monitor_speed = ${common.monitor_speed}
lib_deps = ${common.lib_deps}
; monitor_port=/dev/ttyACM1
; Note: BlackPill F411CE has fewer pins than F407VET6
; Some pin mappings may need adjustment in config.h
